# –°–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ò–ò

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —à–∞–±–ª–æ–Ω–∞–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SBERT —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏.

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### üèóÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îú‚îÄ‚îÄ app_nw.py                    # üü¢ –û–°–ù–û–í–ù–û–ï WEB-–ü–†–ò–õ–û–ñ–ï–ù–ò–ï (Streamlit)
‚îú‚îÄ‚îÄ classification.py            # üü¢ –°–ö–†–ò–ü–¢ –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–ò –î–û–ö–£–ú–ï–ù–¢–û–í
‚îú‚îÄ‚îÄ index_templates.py           # üü¢ –ò–ù–î–ï–ö–°–ê–¶–ò–Ø –®–ê–ë–õ–û–ù–û–í –í –ë–î
‚îú‚îÄ‚îÄ doc_rebuild_app.py          # üî¥ –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îú‚îÄ‚îÄ run_apps.py                 # üî¥ –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îî‚îÄ‚îÄ schema.sql                  # üü¢ –°–•–ï–ú–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•
```

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

```
modules/
‚îú‚îÄ‚îÄ __init__.py                 # üü¢ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ db.py                       # üü¢ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îú‚îÄ‚îÄ embeddings.py               # üü¢ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - SBERT —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
‚îú‚îÄ‚îÄ parsers.py                  # üü¢ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ docx_parser.py              # üü¢ –ü–∞—Ä—Å–∏–Ω–≥ DOCX —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ pdf_parser.py               # üü¢ –ü–∞—Ä—Å–∏–Ω–≥ PDF —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ fast_adaptive_chunker.py    # üü¢ –£–º–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏
‚îú‚îÄ‚îÄ extractor_names.py          # üü¢ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ audit_standart.py           # üü¢ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - –∞–Ω–∞–ª–∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ models_data.py              # üî¥ –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
```

### üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```
data/
‚îú‚îÄ‚îÄ templates/                  # üü¢ –®–ê–ë–õ–û–ù–´ –î–û–ö–£–ú–ï–ù–¢–û–í (48 DOCX, 3 PDF)
‚îî‚îÄ‚îÄ templates_2/                # üü¢ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –®–ê–ë–õ–û–ù–´ (1 DOCX)

input/
‚îú‚îÄ‚îÄ insert_doc/                 # üü¢ –ù–æ–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ standart/              # üü¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã (5 —Ñ–∞–π–ª–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ no_standart/           # üü¢ –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã (5 —Ñ–∞–π–ª–æ–≤)
‚îú‚îÄ‚îÄ isert1/                    # üü¢ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞–±–æ—Ä 1 (7 —Ñ–∞–π–ª–æ–≤)
‚îú‚îÄ‚îÄ isert2/                    # üü¢ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞–±–æ—Ä 2 (8 —Ñ–∞–π–ª–æ–≤)
‚îú‚îÄ‚îÄ isert3/                    # üü¢ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞–±–æ—Ä 3 (4 —Ñ–∞–π–ª–∞)
‚îî‚îÄ‚îÄ isert4/                    # üü¢ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞–±–æ—Ä 4 (4 —Ñ–∞–π–ª–∞)

outputs/
‚îú‚îÄ‚îÄ cache/                     # üü¢ –ö–µ—à –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (7831 PKL)
‚îú‚îÄ‚îÄ index/                     # üü¢ –ò–Ω–¥–µ–∫—Å—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îî‚îÄ‚îÄ media/                     # üü¢ –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (50 PNG)

logo/
‚îî‚îÄ‚îÄ logo_w.svg                 # üü¢ –õ–æ–≥–æ—Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

sours/                         # üü¢ –ò—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ requirements.txt           # üü¢ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ example.txt                # üü¢ –ü—Ä–∏–º–µ—Ä —Ç–µ–∫—Å—Ç–∞
‚îî‚îÄ‚îÄ –î–æ–≥–æ–≤–æ—Ä –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Ñ–æ—Ä–º–µ.txt  # üü¢ –û–±—Ä–∞–∑–µ—Ü –¥–æ–≥–æ–≤–æ—Ä–∞
```

### ü§ñ –ú–æ–¥–µ–ª–∏ –ò–ò

```
models/
‚îú‚îÄ‚îÄ sbert_large_nlu_ru/         # üü¢ –û–°–ù–û–í–ù–ê–Ø - —Ä—É—Å—Å–∫–∞—è SBERT –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ reranker_ru/                # üü° –î–û–°–¢–£–ü–ù–ê - —Ä–µ—Ä–∞–Ω–∫–µ—Ä –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞
‚îî‚îÄ‚îÄ llm/gguf/                   # üü° –î–û–°–¢–£–ü–ù–ê - Phi-3-mini –ª–æ–∫–∞–ª—å–Ω–∞—è LLM
    ‚îî‚îÄ‚îÄ Phi-3-mini-4k-instruct-q4.gguf
```

### ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```
configs/
‚îî‚îÄ‚îÄ app_config.yaml             # üü¢ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

schema.sql                      # üü¢ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - —Å—Ö–µ–º–∞ PostgreSQL –ë–î
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—Ä–∞–≤–∏–ª–∞ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ –º–æ–¥—É–ª–µ `modules/audit_standart.py`

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```mermaid
graph TD
    A[–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞] --> B[–ü–∞—Ä—Å–∏–Ω–≥ parsers.py]
    B --> C[–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è extractor_names.py]
    C --> D[–†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏ fast_adaptive_chunker.py]
    D --> E[–°–æ–∑–¥–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ embeddings.py]
    E --> F[–ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤ db.py]
    F --> G[–ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏ audit_standart.py]
    G --> H[–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ app_nw.py]
```

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL

### –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü:

```sql
-- –®–ê–ë–õ–û–ù–´
templates (id, name, version, created_at, is_active, embedding, title, title_emb)
template_chunks (chunk_id, template_id, ord, heading, text, embedding)

-- –í–•–û–î–Ø–©–ò–ï –î–û–ö–£–ú–ï–ù–¢–´
docs_inserted (id, name, version, created_at, embedding, similar_id, 
               similarity_score, session_id, user_choice_doc_id, title, title_emb)
docs_inserted_chunks (chunk_id, doc_id, ord, heading, text, embedding)
```

## üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### 1Ô∏è‚É£ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ —à–∞–±–ª–æ–Ω–æ–≤
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cp –≤–∞—à_—à–∞–±–ª–æ–Ω.docx data/templates/
# –∏–ª–∏ –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cp –≤–∞—à_—à–∞–±–ª–æ–Ω.docx data/templates_2/
# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: DOCX, PDF
cp –≤–∞—à_—à–∞–±–ª–æ–Ω.pdf data/templates/
```

#### –®–∞–≥ 2: –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤
```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ conda –æ–∫—Ä—É–∂–µ–Ω–∏–µ
conda activate corp_pp_doc

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –æ—Å–Ω–æ–≤–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤
python index_templates.py \
    --templates-dir ./data/templates \
    --sbert-path ./models/sbert_large_nlu_ru \
    --embedding-dim 1024 \
    --chunk-size 350 \
    --batch-size 16 \
    --device cpu \
    --use-db

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä—É–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
python index_templates.py \
    --templates-dir ./data/templates_2 \
    --sbert-path ./models/sbert_large_nlu_ru \
    --embedding-dim 1024 \
    --chunk-size 350 \
    --batch-size 16 \
    --device cpu \
    --use-db
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏:
- `--templates-dir`: –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å —à–∞–±–ª–æ–Ω–∞–º–∏
- `--sbert-path`: –ü—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ SBERT
- `--embedding-dim`: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (1024)
- `--chunk-size`: –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –≤ —Ç–æ–∫–µ–Ω–∞—Ö (350)
- `--batch-size`: –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (16)
- `--device`: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (cpu/cuda)
- `--use-db`: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —à–∞–±–ª–æ–Ω—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ë–î
python -c "
from modules.db import DB
db = DB()
templates = db.get_all_templates()
print(f'–í—Å–µ–≥–æ —à–∞–±–ª–æ–Ω–æ–≤: {len(templates)}')
for t in templates[-5:]:
    print(f'- {t[\"name\"]} (ID: {t[\"id\"][:8]}...)')
"
```

### 2Ô∏è‚É£ –ü—É—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

#### –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:

```
1. –ó–ê–ì–†–£–ó–ö–ê (app_nw.py)
   ‚Üì
   üìÅ –í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è tempfile.TemporaryDirectory()
   ‚Üì
   üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞: temp_dir/filename.docx

2. –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø (classification.py)
   ‚Üì
   üìñ –ü–∞—Ä—Å–∏–Ω–≥: parsers.py ‚Üí parse_file_to_elements()
   ‚Üì
   üè∑Ô∏è –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è: extractor_names.py ‚Üí extract_title_universal()
   ‚Üì
   ‚úÇÔ∏è –ß–∞–Ω–∫–∏–Ω–≥: fast_adaptive_chunker.py ‚Üí chunk_elements()
   ‚Üì
   üß† –≠–º–±–µ–¥–¥–∏–Ω–≥–∏: embeddings.py ‚Üí EmbeddingBackend.encode()
   ‚Üì
   üîç –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö: db.py ‚Üí find_similar_documents_enhanced()

3. –°–û–•–†–ê–ù–ï–ù–ò–ï (db.py)
   ‚Üì
   üíæ docs_inserted: –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∫—É–º–µ–Ω—Ç–µ
   ‚Üì
   üíæ docs_inserted_chunks: —á–∞–Ω–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏

4. –ê–ù–ê–õ–ò–ó –°–¢–ê–ù–î–ê–†–¢–ù–û–°–¢–ò (audit_standart.py)
   ‚Üì
   üìã check_contract_standardness(): –∞–Ω–∞–ª–∏–∑ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º
   ‚Üì
   üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: STANDARD/NONSTANDARD/UNKNOWN + –Ω–∞—Ä—É—à–µ–Ω–∏—è

5. –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï (app_nw.py)
   ‚Üì
   üìà –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   ‚Üì
   üéØ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
   ‚Üì
   ‚öñÔ∏è –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏
```

#### –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- **–í—Ö–æ–¥—è—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã**: `input/` (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)
- **–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –≤–µ–±**: `tempfile.TemporaryDirectory()` (–∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ)
- **–ö–µ—à –ø–∞—Ä—Å–∏–Ω–≥–∞**: `outputs/cache/*.pkl` (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫–µ—à)

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1Ô∏è‚É£ –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

#### A. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Reranker –º–æ–¥–µ–ª–∏
```python
# –í modules/embeddings.py –¥–æ–±–∞–≤–∏—Ç—å:
class RerankerBackend:
    def __init__(self, model_path="./models/reranker_ru"):
        from transformers import AutoTokenizer, AutoModelForSequenceClassification
        self.tokenizer = AutoTokenizer.from_pretrained(model_path)
        self.model = AutoModelForSequenceClassification.from_pretrained(model_path)
    
    def rerank(self, query: str, candidates: List[str], top_k: int = 5):
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ—Ä–∞–Ω–∫–∏–Ω–≥–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏
        pass
```

#### B. –£–ª—É—á—à–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ —Ç–∏–ø–∞–º
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel/PDF
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ/—Ç–∏–ø—É/—Å—Ö–æ–∂–µ—Å—Ç–∏

#### C. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```python
# –î–æ–±–∞–≤–∏—Ç—å Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
import redis
r = redis.Redis(host='localhost', port=6379, db=0)

def get_cached_embedding(text_hash):
    return r.get(f"emb:{text_hash}")

def cache_embedding(text_hash, embedding):
    r.set(f"emb:{text_hash}", embedding.tobytes())
```

### 2Ô∏è‚É£ –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 –º–µ—Å—è—Ü–∞)

#### A. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LLM –º–æ–¥–µ–ª–∏ (Phi-3-mini)
```python
# –ù–æ–≤—ã–π –º–æ–¥—É–ª—å: modules/llm_analyzer.py
class LocalLLMAnalyzer:
    def __init__(self, model_path="./models/llm/gguf/Phi-3-mini-4k-instruct-q4.gguf"):
        from llama_cpp import Llama
        self.llm = Llama(model_path=model_path, n_ctx=4096)
    
    def analyze_contract_differences(self, doc_text: str, template_text: str):
        prompt = f"""
        –°—Ä–∞–≤–Ω–∏ –¥–æ–≥–æ–≤–æ—Ä —Å —à–∞–±–ª–æ–Ω–æ–º –∏ –Ω–∞–π–¥–∏ –æ—Ç–ª–∏—á–∏—è:
        
        –®–ê–ë–õ–û–ù:
        {template_text[:2000]}
        
        –î–û–ö–£–ú–ï–ù–¢:
        {doc_text[:2000]}
        
        –ù–∞–π–¥–∏ –∫–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è:
        """
        return self.llm(prompt, max_tokens=512)
```

#### B. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ
- ‚úÖ –°–±–æ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ä–æ–≥–æ–≤ —Å—Ö–æ–∂–µ—Å—Ç–∏

#### C. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
```python
# modules/analytics.py
class DocumentAnalytics:
    def analyze_trends(self):
        # –¢—Ä–µ–Ω–¥—ã –ø–æ —Ç–∏–ø–∞–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
        # –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏
        pass
    
    def generate_report(self, period: str):
        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã
        pass
```

### 3Ô∏è‚É£ –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (3-6 –º–µ—Å—è—Ü–µ–≤)

#### A. –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ    ‚îÇ   API Gateway   ‚îÇ    ‚îÇ   Auth Service  ‚îÇ
‚îÇ   (Streamlit)   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (FastAPI)     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (JWT/OAuth)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ               ‚îÇ               ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ Classification‚îÇ ‚îÇ  Templates  ‚îÇ ‚îÇ  Analytics ‚îÇ
        ‚îÇ   Service     ‚îÇ ‚îÇ   Service   ‚îÇ ‚îÇ   Service  ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚îÇ
                        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                        ‚îÇ   Database    ‚îÇ
                        ‚îÇ (PostgreSQL + ‚îÇ
                        ‚îÇ    Redis)     ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### B. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π ML Pipeline
```python
# ml_pipeline/
‚îú‚îÄ‚îÄ feature_engineering.py     # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îú‚îÄ‚îÄ model_training.py          # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ model_evaluation.py        # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ hyperparameter_tuning.py   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îî‚îÄ‚îÄ deployment.py              # –î–µ–ø–ª–æ–π –º–æ–¥–µ–ª–µ–π
```

#### C. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- ‚úÖ API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å CRM/ERP
- ‚úÖ Webhook –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç–æ–π
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏

### 4Ô∏è‚É£ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

#### A. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# –î–æ–±–∞–≤–∏—Ç—å –≤ requirements.txt:
# prometheus-client
# grafana-api
# structlog

import structlog
logger = structlog.get_logger()

# –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
from prometheus_client import Counter, Histogram
classification_requests = Counter('classification_requests_total')
processing_time = Histogram('document_processing_seconds')
```

#### B. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# tests/
‚îú‚îÄ‚îÄ test_classification.py     # –¢–µ—Å—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ test_embeddings.py         # –¢–µ—Å—Ç—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îú‚îÄ‚îÄ test_db.py                 # –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ test_parsers.py            # –¢–µ—Å—Ç—ã –ø–∞—Ä—Å–µ—Ä–æ–≤
‚îî‚îÄ‚îÄ test_integration.py        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

#### C. Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
```dockerfile
# Dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 8501

CMD ["streamlit", "run", "app_nw.py", "--server.address", "0.0.0.0"]
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **Python**: 3.9+
- **PostgreSQL**: 12+ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º vector
- **RAM**: 8GB+ (–¥–ª—è SBERT –º–æ–¥–µ–ª–∏)
- **Storage**: 10GB+ (–¥–ª—è –º–æ–¥–µ–ª–µ–π –∏ –∫–µ—à–∞)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ conda –æ–∫—Ä—É–∂–µ–Ω–∏—è
conda create -n corp_pp_doc python=3.9
conda activate corp_pp_doc

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r sours/requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL
export DOCS_PG_DSN="postgresql://user:password@localhost:5432/documents_cem"

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã –ë–î
psql -d documents_cem -f schema.sql
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–¢–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**: ~85% (–ø—Ä–∏ –ø–æ—Ä–æ–≥–µ 80%)
- **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏**: 30-60 —Å–µ–∫/–¥–æ–∫—É–º–µ–Ω—Ç
- **–†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏**: 1.3GB (SBERT)
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã**: DOCX, PDF, TXT

### –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–¢–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**: 95%+
- **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏**: <10 —Å–µ–∫/–¥–æ–∫—É–º–µ–Ω—Ç
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤**: +DOC, RTF, ODT
- **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å**: EN, DE, FR

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö PDF** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å pdf_parser.py
2. **–í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏** - –¥–æ–±–∞–≤–∏—Ç—å batch processing
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å git-like –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **–ù–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ–ª–∏—Ç–∏–∫** - –ø—Ä–∞–≤–∏–ª–∞ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ audit_standart.py

## üìö –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è

- **–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: `app_nw.py`
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: `classification.py`
- **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤**: `index_templates.py`
- **–°—Ö–µ–º–∞ –ë–î**: `schema.sql`
- **–ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—Å—Ç–∏**: `modules/audit_standart.py`
- **–†–∞–±–æ—Ç–∞ —Å –ë–î**: `modules/db.py`
- **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏**: `modules/embeddings.py`

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: $(date)  
**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–ö–æ–Ω—Ç–∞–∫—Ç—ã**: [–≤–∞—à email]
